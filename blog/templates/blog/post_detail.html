{% extends 'blog/blog_base.html' %}
{% load static %}
    

{% block json_ld %}
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "BlogPosting",
                "mainEntityOfPage": {
                    "@type": "WebPage",
                    "@id": "{{ request.scheme }}://{{ request.site }}{% url 'post-detail' post.slug %}"
                },
                "headline": "{{ post.title }}",
                "image": "{{ post.image }}",
                "datePublished": "{{ post.created_at|date:'c' }}",
                "dateModified": "{{ post.updated_at|date:'c' }}",
                "author": {
                    "@type": "Person",
                    "name": "{{ post.author.first_name }} {{ post.author.last_name }}"
                },
                "publisher": {
                    "@type": "Organization",
                    "name": "{{ request.scheme }}://{{ request.site }}",
                    "logo": {
                        "@type": "ImageObject",
                        "url": "https://www.michael-patterson.com/static/images/m_p_favicon.png"
                    }
                }
            }
        </script>
{% endblock json_ld %}


{% block content %}
<section>
    <a class="btn btn-primary" href="{% url 'blog' %}">Blog</a>
    {% if user.is_authenticated %}
    <a class="btn btn-success" href="/admin/blog/post/add/">New Post</a>
    {% endif %}
        

    {% if post.published == False %}
    <h4 class="bg-warning p-1">This post is not published.</h4>
    {% endif %}    
    <h1 class="mt-3">{{ post.title }}</h1>

    <p>{{ post.body|safe }}</p>
    <p>Author: {{ post.author }}</p>
    <p>Created at: {{ post.created_at }}</p>

    
    {% if post.categories.all %}
        
    <p>Categories: 
        
        {% for category in post.categories.all %}

            {{ category }}{% if not forloop.last %}, {% endif %}
                
        {% endfor %}
            
    </p>

    {% endif %}

    {% if post.created_at|date:"M:d:Y" == post.updated_at|date:"M:d:Y" and post.created_at|time:"H:i" != post.updated_at|time:"H:i" %}
        <p>Updated at: {{ post.updated_at }}</p>
    {% elif post.created_at|date:"M:d:Y" != post.updated_at|date:"M:d:Y" %}
        <p>Updated at: {{ post.updated_at }}</p>
    {% endif %}

    {% if user.is_authenticated %}
    <a href="/admin/blog/post/{{ post.pk }}/change/" class="btn btn-warning">Edit</a>
    <a href="/admin/blog/post/{{ post.pk }}/delete/" class="btn btn-danger">Delete</a>
    {% endif %}
</section>        
{% endblock content %}
    