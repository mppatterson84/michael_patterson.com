{% extends 'base.html' %}


{% block json_ld %}
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": ["ItemList", "Blog"],
                "name": "{{ request.site.name }} - {{ title }}",
                "itemListElement":[
                    {% for post in object_list %}
                    {
                        "@type":["ListItem", "BlogPosting"],
                        "position":{{ forloop.counter }},
                        "url":"{{ request.scheme }}://{{ request.site }}{% url 'post-detail' post.slug %}",
                        "headline": "{{ post.title }}",
                        "image": "{{ request.scheme }}://{{ request.site }}/{{ post.image }}"
                    }{% if not forloop.last %},{% endif %}
                    {% endfor %}  
                ]
            }
        </script>
{% endblock json_ld %}


{% block content %}
<section>
    <h1>{{ title }}</h1>
    <a class="btn btn-primary" href="{% url 'post-list-all' %}">All Posts</a>
    <a class="btn btn-primary" href="{% url 'category-list' %}">Categories</a>    
    {% if user.is_authenticated %}
    <a class="btn btn-success" href="{% url 'post-new' %}">New Post</a>
    {% endif %}
        
        {% for post in object_list %}
            <div class="post-entry">
                {% if post.published == False %}
                <h4 class="bg-warning p-1">This post is not published.</h4>
                {% endif %}
                <h2><a href="{% url 'post-detail' post.slug %}">{{ post.title }}</a></h2>
                <p>{{ post.body|truncatewords_html:50|safe }}</p>
            </div>
        {% endfor %}
</section>
{% endblock content %}
    